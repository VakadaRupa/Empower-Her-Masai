CREATE TABLE students (
    id SERIAL PRIMARY KEY,
    name TEXT NOT NULL,
    email TEXT UNIQUE NOT NULL,
    age INTEGER,
    course TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
--Step 2 - Aggregate Queries
-- Count the total number of students
SELECT COUNT(*) AS total_students 
FROM students;

-- Find the average age of students (using AVG, not AVERAGE)
SELECT AVG(age) AS average_age 
FROM students;

-- Find the minimum and maximum age
SELECT MIN(age) AS youngest, MAX(age) AS oldest 
FROM students;

-- Count how many students are enrolled in each course
SELECT course, COUNT(*) AS students_per_course 
FROM students 
GROUP BY course;

-- Count students whose age is greater than 20
SELECT COUNT(*) AS older_than_20 
FROM students 
WHERE age > 20;

-- Display course-wise student count
SELECT course, COUNT(id) AS student_count 
FROM students 
GROUP BY course;

-- Display only courses where student count is greater than 1
SELECT course, COUNT(id) AS student_count 
FROM students 
GROUP BY course 
HAVING COUNT(id) > 1;

-- Display courses sorted by highest student count first
SELECT course, COUNT(id) AS student_count 
FROM students 
GROUP BY course 
ORDER BY student_count DESC;

-- Fetch the latest 3 students based on created_at
SELECT * FROM students 
ORDER BY created_at DESC 
LIMIT 3;

-- Fetch the top 5 oldest students
SELECT * FROM students 
ORDER BY age DESC 
LIMIT 5;

-- Fetch students in a specific course (e.g., 'Computer Science'), sorted by age (descending)
-- Note: Replace 'Computer Science' with a course name actually in your table
SELECT * FROM students 
WHERE course = 'Computer Science' 
ORDER BY age DESC;